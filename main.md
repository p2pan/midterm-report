# P2P Based Anonymous Data Collection System

Zirui Zhao, Jinyang Li, Tai-Sheng Cheng

## Introduction

To improve product quality and user experiences, more and more companies and collecting user's anonymous data. Typically, it will be three steps for collecting anonymous data [1]. First, gather user's insensitive information on client side; Second, send the information back to companies database or other cloud platform [1]. Third, analyze collected data. For each of  step, there is possibility of leaking user's sensitive data. In the first step, the client side software or JavaScript may collect user's privacy actively, which is known as malware or spyware. In the second step, user may expose sensitive information such as ISP or Geo-location due to the network transmission which can be passively collected. In the third step, the companies may find correlation between the anonymous data they collected with other open data to review user's identity [2]. To protect people from leaking their sensitive information, we have software analysis to deal with malware and spyware in the first stage [3] and differentiate privacy [2] in the third stage. However, we do not have many solutions to prevent data leak during the second stage.

Sensitive information can be easily leaked in the second stage, via device fingerprints [4]. Typically, device fingerprints can be acquired passively through browser's behavior or even lower layers of TCP/IP model [5] \[6]. When the user connects directly to the company's server to submit anonymous data, the user's public IP address can easily be acquired in transport layer and the physical location will be exposed by querying IP Geo-location database [7]. Considering most companies are using HTTP or HTTPS protocol for data transmission, they can easily acquire more sensitive data by checking HTTP header. For example, "X-Forwarded-For" field tells the company if the user is using proxy and what the original IP is, and "User-Agent" field tells which browser and operating system the user is using. When it comes to web applications, there will be more ways to track user down. The web application provider can use DNS Leak to find out which DNS server the user is using and use WebRTC to acquire the user's internal IP address. Besides, the JavaScript's behavior, screen resolution, Flash and Java plugins are other side-channels can be used by the companies [8]. According to Mozilla's report, "83.6% of the browsers seen had a unique fingerprint; among those with Flash or Java enabled, 94.2%" [8], which does not include cookies. These fingerprint data can be used to linked with the collected anonymous data. Attackers can easily analyze users preferences or behaviors according to their location or language based on these so called anonymous data, which may lead to specially targeted scam and virus, or Advanced Persistent Threat (APT) [9] such as social engineering.

Traditional ways of privacy protection in second phase are using VPN or Tor to hide the user's real identity. However, these techniques which are trying to hide user's IP are not enough. By using device fingerprint, the company can still track the user behind the Tor [10]. To solve the problem, we introduce our P2P based anonymous data collection system. Instead of trying to hide the identity, we decouple the relation between device fingerprint and collected data. Tracking the origin of anonymous data will be liking finding needle in a haystack.

In our P2P based anonymous data collection system, each peer will hold a queue for each registered application. The queue is filled with fake data specially generated and encrypted with the company’s public key. When an anonymous data record is generated by the user, it will be encrypted with company’s public key and pushed into the queue then pop an old record out. Each peer will randomly pick a data record and broadcast it to other peers after a certain period of time. So, the queue will be filled with the mix of user’s own data, other users’s data, and fake data generated by the company gradually. Because the whole procedure picks data record randomly, people cannot know where a data record is from. While submitting the data record to the company, the queue will be sent in a random order. This mechanism decouples the user’s device fingerprint with  the data submitted.

To prevent bad peer who may inspect or malicious tamper other user’s data, the data record contains anonymous data and its hash value, then it is encrypted by company’s public key. Also, each peer has a speed limiter to block the bad peer who may spam garbage into the P2P network. On the company side, the server will decrypt data record with their private key, filter all the fake data and duplicated data based on its hash value. A possible optimization for the system is running this P2P network as a system level service, to avoid each application implements an independent P2P service and occupy a network port.

## Related Work

### Device Fingerprint

The first empirical study of fingerprint was conducted by Eckersley. He developed a way to generate fingerprint based on browser’s extension [11]. The website, panopticlick.eff.org, maintained by him, collected more than 50,000 users browsers’ information. Based on those data, his method achieved more than 18bits entropy, which means it can identify at least 262,144 browsers before two browsers are considered as the same one on average. Besides using front-end technologies generate fingerprint. Fingerprints can also be generated from lower layer of network stack. Christoph did large-scale study on passive 802.11 device fingerprint [6].  Therefore, the device fingerprint problem occurs both in web applications and traditional desktop software.

### Tor

Tor is an anonymity network software which helps people hiding their real identity. A Tor connection has three Tor nodes involved [12], each node does not know where the packet is come from or where it is going because the packet is encrypted by these nodes’ public key. This mechanism ensures anonymity. However, Tor does not work well in this scenario. Yi Shi proposed a way to create user’s fingerprinting by monitoring incoming and outcoming packets in 2009 [13]. After Yi, Tao Wang improved the quality of fingerprint classification results by introducing new data processing way and fingerprinting metrics in 2013 [10].